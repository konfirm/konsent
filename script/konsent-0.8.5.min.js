/**
 *       __    Konsent (v0.8.5)- a EU-law cookie consent helper library
 *      /\_\
 *   /\/ / /   Copyright 2012, Konfirm (Rogier Spieker)
 *   \  / /    Releases under the MIT and GPL licenses
 *    \/_/     More information: http://konfirm.net/konsent
 */
var Konsent=Konsent||new (function(){var a=this;a.init=function(b){a._enterState(a.state.INIT);a.config=a._mergeObjects(b,a.defaultConfig);a.geo={code:"",country:"",continent:""};a.addStateListener(a.state.CONFIG,function(){a._configure()});if(a.config.respectDoNotTrack&&a._doNotTrack()){return a._enterState(a.state.DO_NOT_TRACK)}a._leaveState(a.state.INIT)};a.delayInit=function(b){var c=function(){a.init(b)};if(typeof window.addStateListener!="undefined"){window.addStateListener("DOMContentLoaded",c,false)}else{window.onload=c}};a.askUserConsent=function(){a.createConsentInterface();if(a.config.animate){var c=a.structure.container,b=c.offsetHeight||c.clientHeight||null;if(b){c.style.height="0px";c.style.overflow="hidden";a._sizeAnimation(c,{height:b},20)}}};a.userConsent=function(b){a.setConsentCookie(b)};a.revokeConsent=function(){a.setConsentCookie(false)};a.setGeoLocation=function(b){a.geo=b;a._leaveState(a.state.CONFIG)};a.getGeoLocation=function(){return a.geo};a.getInterfaceStructure=function(){if(typeof a.structure=="undefined"){var c=document.body.insertBefore(document.createElement("div"),document.body.firstChild),f=c.appendChild(document.createElement("div")),d=f.appendChild(document.createElement("span")),g=f.appendChild(document.createElement("span")),b=f.appendChild(document.createElement("div")),e=b.appendChild(document.createElement("button"));a.structure={container:c,content:f,question:d,extra:b,more:e,action:g,explain:b.appendChild(document.createElement("div")),consent:g.appendChild(document.createElement("button")),decline:g.appendChild(document.createElement("button"))}}return a.structure};a.removeInterfaceStructure=function(){if(typeof a.structure!="undefined"){if(a.config.animate){return a._sizeAnimation(a.structure.container,{height:0},20,function(){a._destroyStructure()})}a._destroyStructure()}};a._destroyStructure=function(){a.structure.container.parentNode.removeChild(a.structure.container);delete a.structure};a.createConsentInterface=function(){var b=a.getInterfaceStructure(),c;for(c in b){b[c].className="konsent_"+c;if(typeof a.config.text[c]!="undefined"){if(/button/i.test(b[c].nodeName)){b[c].appendChild(document.createTextNode(a.config.text[c]))}else{b[c].innerHTML=a.config.text[c]}}}a._applyDefaultStyle();b.consent.onclick=function(){a.userConsent(true);a.removeInterfaceStructure()};b.decline.onclick=function(){a.userConsent(false);a.removeInterfaceStructure()};b.more.onclick=function(){a.structure.more.style.display="none";a.structure.explain.style.display="block";a.structure.explain.style.visibility="hidden";a._sizeAnimation(a.structure.container,{height:a.structure.content.offsetHeight||a.structure.content.clientHeight||null},15,function(){a.structure.explain.style.visibility=""})}};a._getStyleNode=function(c){var d=false,e=document.location.href.match(/([a-z]+:\/\/[a-z_\.-]+)/),b;if(document.styleSheets){for(b=0;b<document.styleSheets.length;++b){if(!document.styleSheets[b].href||(new RegExp(e?e[0]:document.location.href)).test(document.styleSheets[b].href)){d=document.styleSheets[b];break}}if(!d){c.insertBefore(document.createElement("style"),c.firstChild);d=document.styleSheets[0]}}return d};a._applyDefaultStyle=function(){var d=a._getStyleNode((document.head||document.body)),f,b,e;if(d){for(f in a.config.style){b="";for(e in a.config.style[f]){b+=e.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+a.config.style[f][e]+";"}if(b!=""){if(d.insertRule){d.insertRule(".konsent_"+f+" {"+b+"}",0)}else{if(d.addRule){d.addRule(".konsent_"+f,b,0)}}}}}};a.loadScript=function(e,f,c){var b=document.createElement("script"),d=f||function(){};if(c){f=function(){f();b.parentNode.removeChild(b)}}b.type="text/javascript";if(b.onreadystatechange){b.onreadystatechange=function(){if(/complete|loaded/.test(this.readyState)){d()}}}else{if(typeof b.onload!="undefined"){b.onload=d}else{a._scriptLoadPolling(d)}}b.src=e;(document.head||document.getElementsByTagName("head")[0]||document.body).appendChild(b)};a._scriptLoadPolling=function(c){clearTimeout(a._scriptLoadPollingTimer);try{c()}catch(b){a._scriptLoadPollingTimer=setTimeout(function(){a._scriptLoadPolling(c)},50)}};a._configure=function(){var b=a.getConsentCookie();if(typeof b.allow=="boolean"){return a._enterState(b.allow?a.state.HAS_CONSENT:a.state.NO_CONSENT)}else{if((a.config.countries||a.config.continents)){a.loadScript(a.config.geo.provider,a.config.geo.callback)}else{a._leaveState(a.state.CONFIG)}}};a._getStateListeners=function(b){if(typeof a._stateListener=="undefined"){a._stateListener=[]}if(typeof a._stateListener[b]=="undefined"){a._stateListener[b]=[]}return a._stateListener[b]};a.addStateListener=function(c,d){var b=a._getStateListeners(c);b[b.length]=d};a._leaveState=function(b){switch(b){case a.state.INIT:case a.state.CONFIG:a._enterState(b+1);break;case a.state.READY:case a.state.OBTAINED_CONSENT:case a.state.REVOKED_CONSENT:case a.state.IMPLICIT_CONSENT:case a.state.HAS_CONSENT:case a.state.NO_CONSENT:case a.state.DO_NOT_TRACK:default:break}};a._enterState=function(c){a._currentState=c;switch(c){case a.state.INIT:case a.state.CONFIG:break;case a.state.READY:var d=a.getConsentCookie(),b=false;switch(d.allow){case true:a._enterState(a.state.HAS_CONSENT);return;case false:a._enterState(a.state.NO_CONSENT);return;default:if(!b&&a.config.countries){b=(new RegExp("\\b"+a.geo.code+"\\b")).test(a.config.countries)}if(!b&&a.config.continents){b=(new RegExp("\\b"+a.geo.continent+"\\b")).test(a.config.continents)}if(!b){a._enterState(a.state.IMPLICIT_CONSENT);return}break}if(a.config.automaticallyAsk){a.askUserConsent()}break;case a.state.OBTAINED_CONSENT:case a.state.REVOKED_CONSENT:case a.state.IMPLICIT_CONSENT:case a.state.HAS_CONSENT:case a.state.NO_CONSENT:case a.state.DO_NOT_TRACK:default:break}a._currentState=c;a._triggerStateHandler(c)};a._triggerStateHandler=function(e){var c=a._getStateName(e).replace(/[^A-Z]+/g,"").toLowerCase(),d=a._getStateListeners(e),b;if(typeof d!="undefined"){for(b=0;b<d.length;++b){if(e==a._currentState){d[b]()}}}if(e==a._currentState){if(a.config&&a.config.useSimpleEventModel){switch(e){case a.state.INIT:case a.state.CONFIG:case a.state.READY:break;case a.state.IMPLICIT_CONSENT:case a.state.OBTAINED_CONSENT:case a.state.HAS_CONSENT:c="consent";break;case a.state.REVOKED_CONSENT:case a.state.NO_CONSENT:case a.state.DO_NOT_TRACK:c="noconsent";break}}if(typeof a["on"+c]=="function"){a["on"+c].call(a)}}};a.getCookie=function(c){var e=document.cookie.split(";"),b=null,d;for(d=0;d<e.length;++d){b=e[d].match(new RegExp(c+"=(.*)","i"));if(b&&b.length>1){return b[1]}}return""};a.setCookie=function(d,f,b,g,e){var c="";if(b){c=new Date();c.setDate(c.getDate()+b);c=c.toUTCString()}document.cookie=d+"="+f+"; expires="+c+(g?"; path="+g:"")+(e?"; domain="+e:"")};a.getConsentCookie=function(){var d=a.getCookie(a.config.cookie.name),c=d.match(/^(yes|no):([0-9]{13,})$/),b=new Date();return{value:d,allow:(c&&c.length>1?c[1]==a.config.cookie.valueAllowed:null),date:(c&&c.length>2&&b.setTime(c[2])?b:null)}};a.setConsentCookie=function(d){var c=a.getConsentCookie(),b=typeof c.allow!="boolean"||c.allow!=d;a.setCookie(a.config.cookie.name,(d?a.config.cookie.valueAllowed:a.config.cookie.valueDeclined)+":"+(new Date()).getTime(),a.config.cookie.lifetime,a.config.cookie.path,a.config.cookie.domain);if(b){a._enterState(d?a.state.OBTAINED_CONSENT:(c.allow==true?a.state.REVOKED_CONSENT:a.state.NO_CONSENT))}};a.getConsentChoiceAge=function(){var b=(new Date()).getTime(),c=a.getConsentCookie(),d=c&&c.date?b-c.date.getTime():false;return{ms:d,seconds:d?Math.floor(d/=1000):false,minutes:d?Math.floor(d/=60):false,hours:d?Math.floor(d/=60):false,days:d?Math.floor(d/=24):false,weeks:d?Math.floor(d/=7):false}};a._doNotTrack=function(){var b=navigator.doNotTrack||navigator.msDoNotTrack||"unspecified";if(/0|1/.test(b+"")){b=b=="1"?"yes":"no"}return b=="yes"};a._sizeAnimation=function(e,d,b,c){e._animate=function(h){var g=this,f;clearTimeout(h.timer);++h.step;for(f in h.to){g.style[f]=h.smooth(h.from[f],h.to[f],h.step,h.steps)+"px"}if(h.step>=h.steps){if(h.ready){h.ready()}g._animate=null;return}h.timer=setTimeout(function(){g._animate(h)},40)};e._animate({to:d,from:{width:typeof d.width?e.offsetWidth||e.clientHeight||null:null,height:typeof d.height?e.offsetHeight||e.clientHeight||null:null},step:0,steps:b,timer:null,smooth:function(i,h,g,f){return(h-i)/2*((g/=f/2)<1?Math.pow(g,3):(g-=2)*Math.pow(g,2)+2)+i},ready:c})};a._getStateName=function(b){for(var c in a.state){if(a.state[c]==b){return c}}return"unknown"};a._mergeObjects=function(e,b){for(var c in b){if(typeof e[c]!=typeof b[c]){e[c]=b[c]}else{if(b[c] instanceof Object){e[c]=a._mergeObjects(e[c],b[c])}}}return e};a.state={INIT:0,CONFIG:1,READY:2,OBTAINED_CONSENT:3,REVOKED_CONSENT:4,IMPLICIT_CONSENT:5,HAS_CONSENT:6,NO_CONSENT:7,DO_NOT_TRACK:8};a.defaultConfig={cookie:{name:"konsentConsent",lifetime:365,valueAllowed:"yes",valueDeclined:"no",domain:"."+(window.location.host.split(".").splice(-2)).join("."),path:"/"},automaticallyAsk:true,animate:true,respectDoNotTrack:true,countries:["AT","BE","BG","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB",].join(","),continents:false,geo:{provider:"http://konfirm.net/api/geo/summary.jsonp?callback=Konsent.setGeoLocation"},style:{container:{position:"relative",fontFamily:'"Lucida Grande", "Trebuchet MS", Verdana, _sans',backgroundColor:"#111",color:"#fff"},content:{fontSize:"18px",lineHeight:"24px"},extra:{padding:"5px 0"},explain:{display:"none",fontSize:"14px",lineHeight:"18px"}},text:{question:"Do you want to allow non-essential cookies?",more:"Read more",explain:"As of the 26th of May 2012, all EU citizens must provide explicit consent to allow websites to use so called tracking-cookies. These cookies usually derive from other websites which integrate functionality into the website you are visiting.",consent:"Yes, I allow this",decline:"No, thank you"},useSimpleEventModel:true}})();function konsent(a){document&&document.body&&document.head?Konsent.init(a):Konsent.delayInit(a)};